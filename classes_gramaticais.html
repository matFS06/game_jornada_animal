<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Quiz Classes Gramaticais</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>

<style>
  body {
    font-family: Arial, sans-serif;
    max-width: 600px;
    margin: 20px auto;
    background-image: url('classes_gramaticais.png');
    padding: 20px;
    border-radius: 10px;
  }
  h2, h3 {
    text-align: center;
  }
  #score-card {
    margin-bottom: 15px;
    font-weight: bold;
    font-size: 1.1em;
  }
  #question {
    font-size: 1.3em;
    margin-bottom: 15px;
  }
  .answers button {
    display: block;
    width: 100%;
    margin: 8px 0;
    padding: 10px;
    font-size: 1em;
    border-radius: 5px;
    border: 1px solid #555;
    background: white;
    cursor: pointer;
    transition: background-color 0.3s;
  }
  .answers button:hover {
    background: #ddd;
  }
  .feedback {
    margin-top: 15px;
    padding: 12px;
    border-radius: 8px;
    display: none;
    font-size: 1.1em;
  }
  .feedback.correct {
    background-color: #d4edda;
    color: #155724;
  }
  .feedback.wrong {
    background-color: #f8d7da;
    color: #721c24;
  }
  #next-btn {
    margin-top: 15px;
    padding: 10px 20px;
    font-size: 1.1em;
    border: none;
    background-color: #007bff;
    color: white;
    border-radius: 8px;
    cursor: pointer;
    display: none;
  }
  #next-btn:hover {
    background-color: #0056b3;
  }
  #start-screen, #end-screen {
    text-align: center;
  }
  input[type="text"] {
    font-size: 1.1em;
    padding: 8px;
    width: 80%;
    margin-bottom: 15px;
    border-radius: 8px;
    border: 1px solid #aaa;
  }
  button#start-btn {
    font-size: 1.2em;
    padding: 10px 25px;
    border-radius: 8px;
    border: none;
    background-color: #28a745;
    color: white;
    cursor: pointer;
  }
  button#start-btn:hover {
    background-color: #1e7e34;
  }
  .container {
    max-width: 600px;
    margin: 30px auto;
    background-color: white;
    padding: 20px;
    border-radius: 15px;
    border: 5px solid rgb(209, 206, 17);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  }
  .btn {
    font-size: 1.1em;
    padding: 10px 20px;
    border-radius: 8px;
    border: none;
    background-color: #28a745;
    color: white;
    cursor: pointer;
    margin: 10px;
  }
  .btn:hover {
    background-color: #218838;
  }
  .btn-pdf {
    background-color: #27ae60;
  }
  #chart-container {
    width: 100%;
    margin: 20px 0;
    background: #fff;
    padding: 10px;
    border-radius: 8px;
    border: 1px solid #ddd;
  }
</style>
</head>
<body>

<div id="start-screen" class="container">
  <h2>Bem-vindo ao Quiz de Classes Gramaticais!</h2>
  <img src="logo_classes_gramaticais.png" alt="Logo" style="max-width: 250px; margin-bottom: 20px; border-radius: 10%;"/>
  <br>
  <input type="text" id="player-name" placeholder="Digite seu nome" />
  <br />
  <button id="start-btn">Iniciar</button>
</div>

<div id="game-screen" style="display:none;" class="container">
  <div id="score-card"></div>
  <div id="question"></div>
  <div class="answers"></div>
  <div id="feedback" class="feedback"></div>
  <button id="next-btn">Pr√≥xima</button>
</div>

<div id="end-screen" class="container" style="display:none;">
  <h2>üéâ Parab√©ns, <span id="final-player-name"></span>!</h2>
  <p>Voc√™ terminou com <strong><span id="final-score"></span> ponto(s)</strong>!</p>
  
  <div id="chart-container">
    <canvas id="scoreChart"></canvas>
  </div>

  <button class="btn btn-pdf" onclick="generatePDF()">üì• Baixar Boletim PDF</button>
  <br>
  <button class="btn" onclick="location.reload()">üîÑ Jogar Novamente</button>
  <button class="btn" onclick="goToNextModule()">‚û°Ô∏è Pr√≥ximo M√≥dulo</button>
</div>


<script>
const questions = [
  {
    question: "Qual palavra √© um substantivo?",
    answers: ["Bonito", "Casa", "Correr", "Rapidamente"],
    answer: "Casa",
    explanation: "Substantivo √© palavra que nomeia seres, coisas, lugares, como 'Casa'."
  },
  {
    question: "Qual palavra √© um verbo?",
    answers: ["Correr", "Feliz", "Azul", "Em"],
    answer: "Correr",
    explanation: "Verbo √© palavra que expressa a√ß√£o ou estado, como 'Correr'."
  },
  {
    question: "Qual palavra √© um adjetivo?",
    answers: ["Grande", "Ele", "Ou", "Dois"],
    answer: "Grande",
    explanation: "Adjetivo caracteriza ou qualifica o substantivo, como 'Grande'."
  },
  {
    question: "Qual palavra √© um artigo?",
    answers: ["O", "Ela", "Andar", "Felizmente"],
    answer: "O",
    explanation: "Artigo determina o substantivo, como o definido 'O' ou indefinido 'Um'."
  },
  {
    question: "Qual palavra √© um pronome?",
    answers: ["Ele", "Correr", "Azul", "Com"],
    answer: "Ele",
    explanation: "Pronome substitui ou acompanha o substantivo, como 'Ele'."
  },
  {
    question: "Qual palavra √© um numeral?",
    answers: ["Tr√™s", "Casa", "Falar", "Entre"],
    answer: "Tr√™s",
    explanation: "Numeral indica quantidade, ordem, etc., como 'Tr√™s'."
  },
  {
    question: "Qual palavra √© um adv√©rbio?",
    answers: ["Rapidamente", "Do", "Ela", "Feliz"],
    answer: "Rapidamente",
    explanation: "Adv√©rbio modifica verbo, adjetivo ou outro adv√©rbio, como 'Rapidamente'."
  },
  {
    question: "Qual palavra √© uma preposi√ß√£o?",
    answers: ["Com", "Bonito", "Correr", "Eles"],
    answer: "Com",
    explanation: "Preposi√ß√£o liga termos na ora√ß√£o, como 'Com'."
  },
  {
    question: "Qual palavra √© uma conjun√ß√£o?",
    answers: ["E", "Casa", "Ela", "Falar"],
    answer: "E",
    explanation: "Conjun√ß√£o liga ora√ß√µes ou termos, como 'E'."
  },
  {
    question: "Qual palavra √© uma interjei√ß√£o?",
    answers: ["Ah!", "Azul", "Felizmente", "Dois"],
    answer: "Ah!",
    explanation: "Interjei√ß√£o expressa emo√ß√£o, como 'Ah!'."
  },
  {
    question: "Qual dessas palavras √© um artigo definido?",
    answers: ["A", "Ele", "Bonito", "Correr"],
    answer: "A",
    explanation: "Artigos definidos: o, a, os, as."
  },
  {
    question: "Qual palavra √© um pronome pessoal?",
    answers: ["N√≥s", "Casa", "Grande", "De"],
    answer: "N√≥s",
    explanation: "Pronomes pessoais indicam as pessoas do discurso, como 'N√≥s'."
  },
  {
    question: "Qual palavra √© um verbo no infinitivo?",
    answers: ["Falar", "Feliz", "Dois", "Com"],
    answer: "Falar",
    explanation: "Verbo no infinitivo √© o verbo em sua forma b√°sica, como 'Falar'."
  },
  {
    question: "Qual palavra √© um numeral ordinal?",
    answers: ["Primeiro", "Casa", "Ela", "E"],
    answer: "Primeiro",
    explanation: "Numerais ordinais indicam ordem, como 'Primeiro'."
  },
  {
    question: "Qual palavra √© um adv√©rbio de nega√ß√£o?",
    answers: ["N√£o", "Bonito", "Eles", "Do"],
    answer: "N√£o",
    explanation: "Adv√©rbio de nega√ß√£o indica nega√ß√£o, como 'N√£o'."
  },
  {
    question: "Qual dessas palavras √© uma preposi√ß√£o simples?",
    answers: ["Em", "Falar", "Ele", "Ah!"],
    answer: "Em",
    explanation: "Preposi√ß√µes simples s√£o palavras como 'em', 'de', 'a', 'por'."
  },
  {
    question: "Qual palavra √© uma conjun√ß√£o coordenativa?",
    answers: ["Mas", "Grande", "Casa", "Eles"],
    answer: "Mas",
    explanation: "Conjun√ß√£o coordenativa liga ora√ß√µes independentes, como 'Mas'."
  },
  {
    question: "Qual palavra √© uma interjei√ß√£o de surpresa?",
    answers: ["Uau!", "Dois", "Ela", "Com"],
    answer: "Uau!",
    explanation: "Interjei√ß√£o de surpresa expressa espanto, como 'Uau!'."
  },
  {
    question: "Qual palavra √© um substantivo comum?",
    answers: ["Cachorro", "Ele", "E", "N√£o"],
    answer: "Cachorro",
    explanation: "Substantivo comum designa seres em geral, como 'Cachorro'."
  },
  {
    question: "Qual palavra √© um adjetivo comparativo?",
    answers: ["Melhor", "Casa", "Eles", "Falar"],
    answer: "Melhor",
    explanation: "Adjetivo comparativo compara qualidades, como 'Melhor'."
  }
];

function shuffleArray(array) {
  for(let i = array.length - 1; i > 0; i--){
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

let playerName = "";
let score = 0;
let lives = 5;
let current = 0;

// Vari√°veis de Relat√≥rio (Novas)
let scoreHistory = [0];
let reportData = [];

const startBtn = document.getElementById('start-btn');
const questionEl = document.getElementById('question');
const answersEl = document.querySelector('.answers');
const feedbackEl = document.getElementById('feedback');
const nextBtn = document.getElementById('next-btn');
const scoreCard = document.getElementById('score-card');

startBtn.addEventListener('click', startGame);

nextBtn.addEventListener('click', () => {
  current++;
  if(current >= questions.length){
    endGame();
  } else {
    loadQuestion();
  }
});

function startGame(){
  playerName = document.getElementById('player-name').value.trim();
  if(!playerName) {
    alert("Digite seu nome para come√ßar!");
    return;
  }

  score = 0;
  lives = 5;
  current = 0;
  scoreHistory = [0];
  reportData = [];

  shuffleArray(questions);

  document.getElementById('start-screen').style.display = 'none';
  document.getElementById('game-screen').style.display = 'block';
  feedbackEl.style.display = 'none';
  nextBtn.style.display = 'none';

  updateScoreCard();
  loadQuestion();
}

function loadQuestion(){
  feedbackEl.style.display = 'none';
  nextBtn.style.display = 'none';

  const q = questions[current];
  questionEl.textContent = `(${current + 1}/${questions.length}) ${q.question}`;
  answersEl.innerHTML = "";

  const shuffledAnswers = shuffleArray([...q.answers]);

  shuffledAnswers.forEach(ans => {
    const btn = document.createElement('button');
    btn.textContent = ans;
    btn.addEventListener('click', () => selectAnswer(ans, q));
    answersEl.appendChild(btn);
  });
}

function selectAnswer(selected, q){
  Array.from(answersEl.children).forEach(b => b.disabled = true);

  const isCorrect = (selected === q.answer);

  if(isCorrect){
    score += 10;
    feedbackEl.className = 'feedback correct';
    feedbackEl.innerHTML = `‚úÖ Correto!<br>${q.explanation}`;
  } else {
    lives--;
    feedbackEl.className = 'feedback wrong';
    feedbackEl.innerHTML = `‚ùå Errado!<br>${q.explanation}`;
  }

  // Guardar dados para o gr√°fico e PDF
  reportData.push({
    pergunta: q.question,
    escolhida: selected,
    gabarito: q.answer,
    resultado: isCorrect ? "Acertou" : "Errou"
  });
  scoreHistory.push(score);

  updateScoreCard();
  feedbackEl.style.display = 'block';
  nextBtn.style.display = 'inline-block';

  if(lives <= 0){
    setTimeout(() => {
      alert("Suas vidas acabaram! Fim de jogo.");
      endGame();
    }, 200);
  }
}

function updateScoreCard(){
  scoreCard.innerHTML = `<strong>Jogador:</strong> ${playerName} | <strong>Pontua√ß√£o:</strong> ${score} | <strong>Vidas:</strong> ${lives}`;
}

function endGame(){
  document.getElementById('game-screen').style.display = 'none';
  document.getElementById('end-screen').style.display = 'block';
  document.getElementById('final-player-name').textContent = playerName;
  document.getElementById('final-score').textContent = score;
  renderChart();
}

function renderChart() {
  const ctx = document.getElementById('scoreChart').getContext('2d');
  new Chart(ctx, {
    type: 'line',
    data: {
      labels: scoreHistory.map((_, i) => `Q${i}`),
      datasets: [{
        label: 'Evolu√ß√£o dos Pontos',
        data: scoreHistory,
        borderColor: '#007bff',
        backgroundColor: 'rgba(0, 123, 255, 0.1)',
        fill: true,
        tension: 0.3
      }]
    }
  });
}

async function generatePDF() {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  
  doc.setFontSize(20);
  doc.setTextColor(0, 123, 255);
  doc.text("BOLETIM ESCOLAR - CLASSES GRAMATICAIS", 105, 20, { align: "center" });
  
  doc.setFontSize(12);
  doc.setTextColor(0);
  doc.text(`Aluno(a): ${playerName}`, 20, 35);
  doc.text(`Pontua√ß√£o Total: ${score}`, 20, 42);
  doc.text(`Data: ${new Date().toLocaleDateString()}`, 20, 49);

  const rows = reportData.map(item => [item.pergunta, item.escolhida, item.gabarito, item.resultado]);

  doc.autoTable({
    startY: 55,
    head: [['Quest√£o', 'Sua Resposta', 'Gabarito', 'Status']],
    body: rows,
    headStyles: { fillColor: [0, 123, 255] },
    didParseCell: function(data) {
      if (data.column.index === 3 && data.cell.section === 'body') {
        data.cell.styles.textColor = data.cell.raw === 'Acertou' ? [0, 150, 0] : [200, 0, 0];
      }
    }
  });

  doc.save(`Boletim_${playerName}_ClassesGramaticais.pdf`);
}

function goToNextModule() {
  window.location.href = "tempos_e_modos_verbais.html";
}
</script>

</body>
</html>