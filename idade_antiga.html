<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Jogo de CorrespondÃªncia: CivilizaÃ§Ãµes Antigas</title>
  <style>
    body {
      font-family: 'Comic Sans MS', sans-serif;
      background-image: url('background.png');
      color: black;
      text-align: center;
      margin: 0;
    }

    .container {
      max-width: 700px;
      margin: 30px auto;
      background: #eecac4d0;
      padding: 25px;
      border-radius: 15px;
      border: 4px solid #a1887f;
    }

    #nickname-card {
      margin-bottom: 20px;
    }

    #score-card {
      background-color: #d7ccc8;
      color: black;
      padding: 10px;
      margin-bottom: 15px;
      border-radius: 10px;
      border: 2px solid #4e342e;
    }

    .items-container {
      display: flex;
      justify-content: space-around;
      margin-top: 30px;
      flex-wrap: wrap;
    }

    .item, .target {
      width: 120px;
      height: 150px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      margin: 10px;
      border: 2px solid #4e342e;
      border-radius: 10px;
      background-color: #f1f1f1;
      cursor: pointer;
    }

    .drag-item {
      cursor: grab;
    }

    .drag-item:active {
      cursor: grabbing;
    }

    .target {
      background-color: #c8e6c9;
      text-align: center;
      font-weight: bold;
      font-size: 16px;
    }

    #explanation {
      margin-top: 20px;
      background-color: #efebe9;
      color: #3e2723;
      padding: 15px;
      border-radius: 10px;
      display: none;
      text-align: left;
    }

    button {
      padding: 10px 20px;
      margin: 15px 10px 0;
      border: none;
      border-radius: 5px;
      font-size: 14px;
      cursor: pointer;
    }

    #next-btn {
      background-color: #4CAF50;
      color: white;
      margin-top: 20px;
      width: 200px;
      margin-left: auto;
      margin-right: auto;
    }

    #final-screen {
      display: none;
    }

    #player-name {
      font-size: 18px;
      padding: 8px;
      width: 80%;
      max-width: 300px;
      margin-bottom: 20px;
    }

    .item-name {
      font-weight: bold;
      font-size: 14px;
      margin-top: 10px;
      text-align: center;
    }

    .item img {
      max-width: 100%;
      max-height: 120px;
      object-fit: contain;
    }
  </style>
</head>
<body>

  <div class="container" id="start-screen">
    <h2>Jogo das CivilizaÃ§Ãµes Antigas</h2>
    <img src="logo_civilizacoes.png" alt="Logo CivilizaÃ§Ãµes" style="max-width: 250px; margin-bottom: 20px; border-radius: 10%;"><br>
    <input type="text" id="player-name" placeholder="Digite seu nome"><br>
    <button onclick="startGame()">Iniciar</button>
  </div>

  <div class="container" id="game-container" style="display: none;">
    <div id="nickname-card">
      <strong>Jogador:</strong> <span id="player-display"></span> |
      <strong>PontuaÃ§Ã£o:</strong> <span id="score">0</span>/90
    </div>

    <h3>Arraste as imagens para as civilizaÃ§Ãµes corretas</h3>

    <div class="items-container" id="items-container">
      <!-- Aqui serÃ£o os itens arrastÃ¡veis -->
    </div>

    <div class="items-container" id="targets-container">
      <!-- Aqui serÃ£o as caixas de destino -->
    </div>

    <button id="next-btn" onclick="nextPhase()">PrÃ³xima Fase</button>

    <div id="explanation"></div>
  </div>

  <div id="final-screen" class="container text-center" style="display: none;">
    <h2>ðŸŽ‰ ParabÃ©ns, <span id="final-player-name"></span>!</h2>
    <p>VocÃª completou o jogo com <strong><span id="final-score"></span> ponto(s)</strong>!</p>
    <button onclick="restartGame()">ðŸ”„ Jogar Novamente</button>
  </div>

  <script>
    const phases = [
      {
        items: [
          { name: "CÃ³digos de Hamurabi", image: "codigo_hamurabi.jpg", civilization: "MesopotÃ¢mia", explanation: "O cÃ³digo de Hamurabi foi uma das primeiras leis escritas, que estabeleciam um sistema legal para a MesopotÃ¢mia." },
          { name: "PirÃ¢mides de GizÃ©", image: "piramides_gize.jpg", civilization: "Egito", explanation: "As pirÃ¢mides de GizÃ© sÃ£o uma das Sete Maravilhas do Mundo Antigo, usadas como tumbas para os faraÃ³s egÃ­pcios." },
          { name: "Filosofia de SÃ³crates", image: "filosofia_socrates.jpg", civilization: "GrÃ©cia", explanation: "SÃ³crates Ã© um dos filÃ³sofos mais importantes da GrÃ©cia, conhecido por seu mÃ©todo de questionamento e busca pela verdade." }
        ],
        targets: ["MesopotÃ¢mia", "Egito", "GrÃ©cia"]
      },
      {
        items: [
          { name: "Rios Tigre e Eufrates", image: "rios_tigre_eufrates.jpg", civilization: "MesopotÃ¢mia", explanation: "Os rios Tigre e Eufrates proporcionaram as condiÃ§Ãµes ideais para o surgimento das primeiras civilizaÃ§Ãµes." },
          { name: "MÃºmias EgÃ­pcias", image: "mumia_egipcia.jpg", civilization: "Egito", explanation: "A mumificaÃ§Ã£o era um ritual importante no Egito, acreditando-se que preservava o corpo para a vida apÃ³s a morte." },
          { name: "Teatro Grego", image: "teatro_grego.jpg", civilization: "GrÃ©cia", explanation: "O teatro grego foi uma das primeiras formas de expressÃ£o artÃ­stica em grande escala e influenciou toda a cultura ocidental." }
        ],
        targets: ["MesopotÃ¢mia", "Egito", "GrÃ©cia"]
      },
      {
        items: [
          { name: "ImpÃ©rio AcÃ¡dio", image: "imperio_acadio.jpg", civilization: "MesopotÃ¢mia", explanation: "O ImpÃ©rio AcÃ¡dio, fundado por SargÃ£o da AcÃ¡dia, foi o primeiro impÃ©rio multirracial da histÃ³ria, unificando as cidades-estado da MesopotÃ¢mia sob um Ãºnico governo." },
          { name: "Esfinge", image: "esfinge.jpg", civilization: "Egito", explanation: "A Esfinge Ã© uma estÃ¡tua monumental que simboliza o poder do faraÃ³ e a relaÃ§Ã£o com os deuses." },
          { name: "AcrÃ³pole de Atenas", image: "acropole_atenas.jpg", civilization: "GrÃ©cia", explanation: "A AcrÃ³pole de Atenas Ã© um conjunto de monumentos antigos, incluindo o Parthenon, que simboliza a glÃ³ria da civilizaÃ§Ã£o grega clÃ¡ssica." }
        ],
        targets: ["MesopotÃ¢mia", "Egito", "GrÃ©cia"]
      },
      {
        items: [
          { name: "Zigurate", image: "zigurate.jpg", civilization: "MesopotÃ¢mia", explanation: "Os zigurates eram templos construÃ­dos nas cidades da MesopotÃ¢mia, dedicados aos deuses." },
          { name: "CleÃ³patra", image: "cleopatra.jpg", civilization: "Egito", explanation: "CleÃ³patra VII foi a Ãºltima rainha do Egito, famosa por sua inteligÃªncia e por seus encontros com JÃºlio CÃ©sar e Marco AntÃ´nio." },
          { name: "PanteÃ£o Grego", image: "panteao_grego.jpg", civilization: "GrÃ©cia", explanation: "O PanteÃ£o Grego Ã© composto pelos deuses da mitologia grega, como Zeus, Atena e Apolo." }
        ],
        targets: ["MesopotÃ¢mia", "Egito", "GrÃ©cia"]
      },
      {
        items: [
          { name: "Escrita Cuneiforme", image: "escrita_cuneiforme.jpg", civilization: "MesopotÃ¢mia", explanation: "A escrita cuneiforme Ã© uma das primeiras formas de escrita desenvolvidas na MesopotÃ¢mia." },
          { name: "Rio Nilo", image: "rio_nilo.jpg", civilization: "Egito", explanation: "O Rio Nilo foi essencial para a sobrevivÃªncia e o desenvolvimento do Egito Antigo, fornecendo Ã¡gua, transporte e fertilizando as terras agrÃ­colas." },
          { name: "Democracia Grega", image: "democracia_grega.jpg", civilization: "GrÃ©cia", explanation: "A GrÃ©cia Antiga Ã© o berÃ§o da democracia, onde cidadÃ£os podiam participar diretamente das decisÃµes do governo." }
        ],
        targets: ["MesopotÃ¢mia", "Egito", "GrÃ©cia"]
      },
      {
        items: [
          { name: "A Lei de Ur-Nammu", image: "lei_ur_nammu.jpg", civilization: "MesopotÃ¢mia", explanation: "A Lei de Ur-Nammu Ã© um dos primeiros cÃ³digos legais, prefigurando as leis de Hamurabi." },
          { name: "O Livro dos Mortos", image: "livro_mortos.jpg", civilization: "Egito", explanation: "O Livro dos Mortos era um conjunto de textos usados pelos egÃ­pcios para guiar as almas para a vida apÃ³s a morte." },
          { name: "A RepÃºblica de PlatÃ£o", image: "republica_platao.jpg", civilization: "GrÃ©cia", explanation: "A 'RepÃºblica' de PlatÃ£o Ã© uma obra filosÃ³fica que discute justiÃ§a, polÃ­tica e a natureza do governo ideal." }
          ],
        targets: ["MesopotÃ¢mia", "Egito", "GrÃ©cia"]
      }
    ];

    let currentPhaseIndex = 0;
    let playerName = "";
    let score = 0;
    let correctItemsCount = 0;

    function startGame() {
      playerName = document.getElementById("player-name").value;
      if (playerName.trim() === "") {
        alert("Por favor, insira seu nome!");
        return;
      }

      document.getElementById("player-display").innerText = playerName;
      document.getElementById("start-screen").style.display = "none";
      document.getElementById("game-container").style.display = "block";

      loadPhase();
    }

    function loadPhase() {
      const phase = phases[currentPhaseIndex];
      shuffleArray(phase.items);
      correctItemsCount = 0;

      const itemsContainer = document.getElementById("items-container");
      itemsContainer.innerHTML = "";
      const targetsContainer = document.getElementById("targets-container");
      targetsContainer.innerHTML = "";

      phase.items.forEach(item => {
        const itemDiv = document.createElement("div");
        itemDiv.className = "item drag-item";
        itemDiv.draggable = true;
        itemDiv.innerHTML = `
          <div class="item-name">${item.name}</div>
          <img src="${item.image}" alt="${item.name}" />
        `;
        itemDiv.addEventListener("dragstart", (e) => handleDragStart(e, item));
        itemDiv.addEventListener("touchstart", (e) => handleTouchStart(e, item)); // Novo
        itemsContainer.appendChild(itemDiv);
      });

      phase.targets.forEach(target => {
        const targetDiv = document.createElement("div");
        targetDiv.className = "target";
        targetDiv.innerText = target;
        targetDiv.addEventListener("dragover", handleDragOver);
        targetDiv.addEventListener("drop", (e) => handleDrop(e, target));
        targetDiv.addEventListener("touchover", (e) => handleTouchOver(e)); // Novo
        targetDiv.addEventListener("touchend", (e) => handleTouchDrop(e, target)); // Novo
        targetsContainer.appendChild(targetDiv);
      });

      document.getElementById("next-btn").disabled = false;
      document.getElementById("next-btn").style.backgroundColor = "#4CAF50";
      document.getElementById("next-btn").style.pointerEvents = "auto";
      document.getElementById("explanation").style.display = "none";
    }

    function handleDragStart(event, item) {
      event.dataTransfer.setData("item", JSON.stringify(item));
    }

    // Novo: ManipulaÃ§Ã£o do toque
    function handleTouchStart(event, item) {
      const touch = event.touches[0];
      const dataTransfer = { setData: (key, value) => {} }; // Mock de dataTransfer
      handleDragStart({ ...event, dataTransfer }, item);
    }

    function handleDragOver(event) {
      event.preventDefault();
    }

    // Novo: ManipulaÃ§Ã£o do toque
    function handleTouchOver(event) {
      event.preventDefault();
    }

    // Novo: ManipulaÃ§Ã£o do toque para drop
    function handleTouchDrop(event, target) {
      const touch = event.changedTouches[0];
      const targetDiv = event.target;
      const item = JSON.parse(localStorage.getItem("draggedItem"));

      if (item.civilization === target) {
        targetDiv.style.backgroundColor = "#A5D68D";
        score += 5;
        document.getElementById("score").innerText = score;
        correctItemsCount++;
        showExplanation(item.explanation, true);
      } else {
        targetDiv.style.backgroundColor = "#FFCDD2";
        showExplanation("Ops, vocÃª se enganou. Tente novamente.", false);
      }

      checkPhaseCompletion();
    }

    function handleDrop(event, target) {
      event.preventDefault();
      const data = event.dataTransfer.getData("item");
      const item = JSON.parse(data);
      const targetDiv = event.target;

      if (item.civilization === target) {
        targetDiv.style.backgroundColor = "#A5D68D";
        score += 5;
        document.getElementById("score").innerText = score;
        correctItemsCount++;
        showExplanation(item.explanation, true);
      } else {
        targetDiv.style.backgroundColor = "#FFCDD2";
        showExplanation("Ops, vocÃª se enganou. Tente novamente.", false);
      }

      checkPhaseCompletion();
    }

    function showExplanation(explanation, correct) {
      const explanationDiv = document.getElementById("explanation");
      explanationDiv.innerHTML = explanation;
      explanationDiv.style.display = "block";
    }

    function checkPhaseCompletion() {
      if (correctItemsCount === phases[currentPhaseIndex].items.length) {
        document.getElementById("next-btn").disabled = false;
      } else {
        document.getElementById("next-btn").disabled = true;
      }
    }

    function nextPhase() {
      if (correctItemsCount === phases[currentPhaseIndex].items.length) {
        currentPhaseIndex++;
        if (currentPhaseIndex < phases.length) {
          loadPhase();
        } else {
          showFinalScreen();
        }
      }
    }

    function showFinalScreen() {
      document.getElementById("game-container").style.display = "none";
      document.getElementById("final-screen").style.display = "block";
      document.getElementById("final-player-name").innerText = playerName;
      document.getElementById("final-score").innerText = score;
    }

    function restartGame() {
      document.getElementById("final-screen").style.display = "none";
      document.getElementById("start-screen").style.display = "block";
      score = 0;
      currentPhaseIndex = 0;
    }

    function shuffleArray(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]]; 
      }
    }
  </script>

</body>
</html>
